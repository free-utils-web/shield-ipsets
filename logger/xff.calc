=IF($I1="-",
  IF(ISERROR(REGEX($P1,"((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}")),
    "-",
    CONCATENATE("--"; $P1; "++")),
  $I1)

