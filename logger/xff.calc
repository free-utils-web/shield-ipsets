=IF($I1707="-",
  IF(ISERROR(REGEX($P1707,"((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}")),
    "-",
    CONCATENATE("--"; $P1707; "++")),
  $I1707)
